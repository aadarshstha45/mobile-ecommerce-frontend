import{j as e,g as M,F as R,L as $,I as P,T as h,r as v,Y as _,an as k,ao as q,ap as A,aq as E,aM as H,ar as O,P as V,Q as N,ab as D,V as W,aN as Y,a as w,W as G}from"./index-Cz7Rk_E5.js";import{a as Q,b as X,c as J}from"./index-D3LKjGLM.js";import{T as z,a as B,b as L,c as b,d,e as I,f as m}from"./chunk-MGVPL3OH-C1UU6JfR.js";import"./SelectInput-C8iCJy8O.js";import{a as K}from"./TextInput-CcuL40eV.js";import{o as U,n as T,s as Z,t as ee}from"./zod-B7Gb34Qn.js";import{S as se}from"./chunk-6SZ7MXCX-C2k62tUZ.js";import{F as C}from"./chunk-H46NUPBZ-rhq8btBV.js";import{R as ae,a as re}from"./chunk-RDF2AYID-CbmYy6ie.js";import{T as oe,b as ne,c as te,d as ie,e as F}from"./chunk-IAXSQ4X2-nz7gdjPf.js";import"./x-BJ0XnEhO.js";const le=()=>{const{data:r,isPending:n}=Q();return n?e.jsx(M,{}):r&&r.length>0?e.jsx(z,{children:e.jsxs(B,{colorScheme:"primary",children:[e.jsx(L,{children:e.jsxs(b,{children:[e.jsx(d,{children:"Product"}),e.jsx(d,{children:"Rating"}),e.jsx(d,{children:"Review"})]})}),e.jsx(I,{children:r.map((s,t)=>{var o,i,c;return e.jsxs(b,{children:[e.jsx(m,{children:e.jsxs(R,{gap:4,as:$,to:s.subcategory?`/products/${(o=s.category)==null?void 0:o.slug}/${(i=s.subcategory)==null?void 0:i.slug}/${s.id}`:`/products/${(c=s.category)==null?void 0:c.slug}/${s.id}`,children:[e.jsx(P,{src:s.product.image,alt:s.product.name,boxSize:"100px",objectFit:"cover"}),e.jsx(h,{children:s.product.name})]})}),e.jsx(m,{children:s.rating}),e.jsx(m,{children:s.review})]},t)})})]})}):e.jsx(h,{children:"No reviews found"})},ce=U({product_id:T(),rating:T().min(1,{message:"Rating is required"}),review:Z().min(1,{message:"Review is required"})}),de=({onClose:r,isOpen:n,productId:s})=>{const[t,o]=v.useState(-1),{control:i,handleSubmit:c,setValue:j,reset:f,formState:{errors:a}}=_({defaultValues:{product_id:s,rating:0,review:""},resolver:ee(ce)});v.useEffect(()=>{s!==null&&j("product_id",s)},[s,j]);const{mutateAsync:y,isPending:p}=X(),u=async g=>{await y(g),r()},x=()=>{r(),f(),o(-1)};return e.jsxs(k,{isOpen:n,onClose:x,motionPreset:"slideInTop",children:[e.jsx(q,{}),e.jsxs(A,{children:[e.jsx(E,{}),e.jsx(H,{children:"Add Review"}),e.jsx(O,{children:e.jsxs("form",{onSubmit:c(u),id:"review-form",noValidate:!0,children:[e.jsxs(V,{mb:4,children:[e.jsx(C,{mb:2,fontSize:{sm:"14px",md:"16px"},fontWeight:450,children:"Rating"}),e.jsx(N,{name:"rating",control:i,render:({field:{onChange:g,value:S}})=>e.jsx(ae,{value:S.toString(),onChange:g,onMouseLeave:()=>o(-1),children:e.jsx(D,{gap:0,children:[...Array(5)].map((he,l)=>e.jsxs(C,{htmlFor:`rating_${l}`,onMouseEnter:()=>o(l+1),onClick:()=>g(l+1),cursor:"pointer",children:[e.jsx(se,{w:6,h:6,color:l<(t>=0?t:S)?"yellow.400":"gray.300"}),e.jsx(re,{display:"none",id:`rating_${l}`,value:(l+1).toString()})]},l))})})}),a.rating&&e.jsx(W,{color:"red.400",fontSize:{base:"14px",md:"16px"},fontStyle:"italic",children:a.rating.message})]}),e.jsx(K,{errors:a,type:"textarea",control:i,name:"review",label:"Review",isRequired:!0})]})}),e.jsxs(Y,{gap:1,children:[e.jsx(w,{size:"sm",colorScheme:"gray",variant:"outline",onClick:x,children:"Cancel"}),e.jsx(w,{size:"sm",form:"review-form",type:"submit",isLoading:p,children:"Submit"})]})]})]})},me=()=>{const{data:r,isPending:n}=J(),[s,t]=v.useState(null),{isOpen:o,onOpen:i,onClose:c}=G(),j=a=>{t(a),i()},f=()=>{t(null),c()};return e.jsxs(e.Fragment,{children:[e.jsx(de,{onClose:f,isOpen:o,productId:s}),n?e.jsx(M,{}):r&&r.length>0?e.jsx(z,{children:e.jsxs(B,{colorScheme:"primary",children:[e.jsx(L,{children:e.jsxs(b,{children:[e.jsx(d,{children:"Product"}),e.jsx(d,{}),e.jsx(d,{children:"Review"})]})}),e.jsx(I,{children:r.map((a,y)=>{var p,u,x;return e.jsxs(b,{children:[e.jsx(m,{children:e.jsxs(R,{gap:4,as:$,to:a.subcategory?`/products/${(p=a.category)==null?void 0:p.slug}/${(u=a.subcategory)==null?void 0:u.slug}/${a.id}`:`/products/${(x=a.category)==null?void 0:x.slug}/${a.id}`,children:[e.jsx(P,{src:a.image,alt:a.name,w:{base:"100px",md:"150px"},aspectRatio:1/1}),e.jsx(h,{fontSize:{base:"14px",md:"16px",lg:"18px"},children:a.name})]})}),e.jsx(m,{}),e.jsx(m,{children:e.jsx(w,{onClick:()=>j(a.id),variant:"outline",children:"Review"})})]},y)})})]})}):e.jsx(h,{children:"No orders left to be reviewed"})]})},xe=[{name:"To Review"},{name:"Reviewed"}],Te=()=>e.jsxs(R,{w:"full",flexDir:"column",gap:4,children:[e.jsx(h,{fontSize:"xl",children:"My Reviews"}),e.jsxs(oe,{isLazy:!0,position:"relative",variant:"unstyled",children:[e.jsx(ne,{whiteSpace:"nowrap",overflowX:"auto",overflowY:"hidden",children:xe.map((r,n)=>e.jsx(te,{_selected:{borderBottomColor:"primary.500"},borderBottom:"5px solid",borderBottomColor:"primary.50",fontSize:{base:"sm",md:"md",xl:"lg"},whiteSpace:"nowrap",children:r.name},n))}),e.jsxs(ie,{mt:8,children:[e.jsx(F,{p:0,children:e.jsx(me,{})}),e.jsx(F,{p:0,children:e.jsx(le,{})})]})]})]});export{Te as default};
