import{r as p,k as N,l as A,n as V,q as _,j as t,C as k,F,S as H,T as W,s as $,L as J,B as z,M as U,t as q,H as Q,R as G}from"./index-CHqn2l2u.js";import{d as K,c as X,I as Y}from"./index-CoO67HqL.js";import{L as Z}from"./index-GiGp-AZ7.js";import{B as ee}from"./index-Br5e2vSC.js";import{s as te,F as se,C as E,a as L,S as re}from"./data-DbIVBVHt.js";import{S as ne}from"./SelectInput-DSLuIYVe.js";import"./index-CXYI0z4z.js";import"./GoogleIcon-mZ5X8_-P.js";import"./index.esm-CKUlnAtw.js";import"./TextInput-om9h2xqn.js";import"./x-D2h_KaVa.js";import"./chunk-H46NUPBZ-BU6tGVc5.js";import"./auth-DU7fQ92f.js";import"./zod-BnQ4q-Hn.js";import"./chunk-EC6XFFZH-D65i7NVE.js";import"./chunk-6SZ7MXCX-H2UkuL4n.js";import"./chunk-2EW3JUUD-DeeEOlei.js";import"./chunk-YQO7BFFX-CQYSGleK.js";import"./chunk-FHHZMTWR-Bkx45aSm.js";import"./shopping-bag-B8N_x3AI.js";import"./chevron-right-B9Y5LZMK.js";var P=new Map,I=new WeakMap,M=0,ie=void 0;function oe(e){return e?(I.has(e)||(M+=1,I.set(e,M.toString())),I.get(e)):"0"}function ae(e){return Object.keys(e).sort().filter(s=>e[s]!==void 0).map(s=>`${s}_${s==="root"?oe(e.root):e[s]}`).toString()}function ce(e){const s=ae(e);let i=P.get(s);if(!i){const l=new Map;let d;const n=new IntersectionObserver(o=>{o.forEach(r=>{var a;const x=r.isIntersecting&&d.some(u=>r.intersectionRatio>=u);e.trackVisibility&&typeof r.isVisible>"u"&&(r.isVisible=x),(a=l.get(r.target))==null||a.forEach(u=>{u(x,r)})})},e);d=n.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),i={id:s,observer:n,elements:l},P.set(s,i)}return i}function le(e,s,i={},l=ie){if(typeof window.IntersectionObserver>"u"&&l!==void 0){const a=e.getBoundingClientRect();return s(l,{isIntersecting:l,target:e,intersectionRatio:typeof i.threshold=="number"?i.threshold:0,time:0,boundingClientRect:a,intersectionRect:a,rootBounds:a}),()=>{}}const{id:d,observer:n,elements:o}=ce(i),r=o.get(e)||[];return o.has(e)||o.set(e,r),r.push(s),n.observe(e),function(){r.splice(r.indexOf(s),1),r.length===0&&(o.delete(e),n.unobserve(e)),o.size===0&&(n.disconnect(),P.delete(d))}}function ue({threshold:e,delay:s,trackVisibility:i,rootMargin:l,root:d,triggerOnce:n,skip:o,initialInView:r,fallbackInView:a,onChange:x}={}){var u;const[j,w]=p.useState(null),y=p.useRef(),[g,B]=p.useState({inView:!!r,entry:void 0});y.current=x,p.useEffect(()=>{if(o||!j)return;let h;return h=le(j,(R,b)=>{B({inView:R,entry:b}),y.current&&y.current(R,b),b.isIntersecting&&n&&h&&(h(),h=void 0)},{root:d,rootMargin:l,threshold:e,trackVisibility:i,delay:s},a),()=>{h&&h()}},[Array.isArray(e)?e.toString():e,j,d,l,n,o,i,a,s]);const v=(u=g.entry)==null?void 0:u.target,C=p.useRef();!j&&v&&!n&&!o&&C.current!==v&&(C.current=v,B({inView:!!r,entry:void 0}));const f=[w,g.inView,g.entry];return f.ref=f[0],f.inView=f[1],f.entry=f[2],f}const Le=()=>{const{ref:e,inView:s}=ue(),[i,l]=p.useState(""),d=N(),[n]=A("(max-width: 540px)"),o=V(),r=o.pathname.split("/")[1].replace(/-/g," "),a=new URLSearchParams(o.search),x=a.get("sort")||"",[u,j]=p.useState([]),[w,y]=p.useState([]),{data:g,fetchNextPage:B,isFetchingNextPage:v,hasNextPage:C,isPending:f}=K(i,JSON.stringify(u),JSON.stringify(w));p.useEffect(()=>{l(x)},[x]),p.useEffect(()=>{s&&C&&!v&&B()},[s,C,v]);const h=m=>{l(m.value),m.value!==""&&(a.set("sort",m.value),d(`?${a.toString()}`))},R=(m,S)=>{j(m.target.checked?[...u,S]:u.filter(c=>c!==S)),window.scroll({top:0,behavior:"smooth"})},b=(m,S)=>{y(m.target.checked?[...w,S]:w.filter(c=>c!==S)),window.scroll({top:0,behavior:"smooth"})},{isOpen:O,onOpen:T,onClose:D}=_();return t.jsxs(k,{as:"section",id:"collection",maxW:{base:"98vw",md:"95vw"},py:10,children:[t.jsxs(F,{gap:4,flexDir:n?"column":"row",justify:n?"center":"space-between",align:n?"start":"space-between",children:[t.jsxs(H,{gap:2,children:[t.jsx(W,{fontSize:{base:"18px",sm:"20px",md:"22px",lg:"24px"},fontWeight:500,textTransform:"capitalize",children:r}),t.jsx(ee,{})]}),t.jsx(ne,{isControlled:!1,value:i,placeholder:"Sort by",name:"sort",handleChange:h,options:te})]}),t.jsxs(se,{isOpen:O,onClose:D,children:[t.jsx(E,{}),t.jsx(L,{handleSizeSelect:R,handleColorSelect:b})]}),t.jsx($,{"aria-label":"Filter",as:re,cursor:"pointer",size:"xs",p:1,colorScheme:"gray",display:{base:"block",sm:"none"},onClick:T}),t.jsxs(F,{py:4,gap:4,children:[t.jsx(F,{w:{sm:"200px",md:"250px"},display:{base:"none",sm:"flex"},minH:window.innerHeight,children:t.jsxs(F,{flexDir:"column",gap:4,w:"full",children:[t.jsx(E,{}),t.jsx(L,{handleSizeSelect:R,handleColorSelect:b})]})}),f?t.jsx(J,{}):t.jsxs(F,{flexDir:"column",gap:4,w:"full",children:[g==null?void 0:g.pages.map((m,S)=>t.jsx(z,{children:t.jsx(U,{columnsCountBreakPoints:X,children:t.jsx(q,{gutter:n?"10px":"20px",children:m.data.map(c=>t.jsx(Y,{data:c,discountPercent:c==null?void 0:c.discount,colorOptions:(c==null?void 0:c.product_properties)&&c.product_properties},c.id))})})},S)),t.jsx(z,{ref:e,h:"1px"}),t.jsx(Q,{gap:4,py:10,align:"center",justify:"center",children:v&&t.jsx(G,{as:Z,boxSize:20})})]})]})]})};export{Le as default};
