import{r as u,k as A,l as H,n as V,aL as _,q as k,j as t,C as W,F,S as $,T as J,s as U,t as z,L as q,B as L,M as Q,v as G,H as K}from"./index-DXOl-lRy.js";import{L as X}from"./index-CAtL-YdI.js";import{B as Y}from"./index-CeqLYgft.js";import{s as Z,F as ee,C as M,a as O,H as te}from"./data-CW3imzhC.js";import{S as se}from"./SelectInput-CBJ-QJ5T.js";import{c as re,I as ne}from"./index-D8nJik0V.js";import"./CaretRight-DC7Ez03o.js";import"./index.esm-B76apoH1.js";import"./chunk-H46NUPBZ-B2fS6ZKh.js";import"./index-HIWz4M9P.js";import"./GoogleIcon-BGi4GK1e.js";import"./Lock-CmbDNgON.js";import"./TextInput-Bbe4oRry.js";import"./X-D6iB-bui.js";import"./auth-COrfOVxh.js";import"./zod-DRSu9NPM.js";import"./profile-Bo9Efvi4.js";import"./review-DfTV1ghI.js";import"./chunk-2EW3JUUD-zgUE6b5T.js";import"./chunk-YQO7BFFX-C0Z8zC1H.js";import"./chunk-FHHZMTWR-BZgCZ-H3.js";var I=new Map,E=new WeakMap,T=0,ie=void 0;function oe(e){return e?(E.has(e)||(T+=1,E.set(e,T.toString())),E.get(e)):"0"}function ae(e){return Object.keys(e).sort().filter(s=>e[s]!==void 0).map(s=>`${s}_${s==="root"?oe(e.root):e[s]}`).toString()}function ce(e){const s=ae(e);let o=I.get(s);if(!o){const l=new Map;let f;const i=new IntersectionObserver(n=>{n.forEach(r=>{var a;const x=r.isIntersecting&&f.some(d=>r.intersectionRatio>=d);e.trackVisibility&&typeof r.isVisible>"u"&&(r.isVisible=x),(a=l.get(r.target))==null||a.forEach(d=>{d(x,r)})})},e);f=i.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),o={id:s,observer:i,elements:l},I.set(s,o)}return o}function le(e,s,o={},l=ie){if(typeof window.IntersectionObserver>"u"&&l!==void 0){const a=e.getBoundingClientRect();return s(l,{isIntersecting:l,target:e,intersectionRatio:typeof o.threshold=="number"?o.threshold:0,time:0,boundingClientRect:a,intersectionRect:a,rootBounds:a}),()=>{}}const{id:f,observer:i,elements:n}=ce(o),r=n.get(e)||[];return n.has(e)||n.set(e,r),r.push(s),i.observe(e),function(){r.splice(r.indexOf(s),1),r.length===0&&(n.delete(e),i.unobserve(e)),n.size===0&&(i.disconnect(),I.delete(f))}}function ue({threshold:e,delay:s,trackVisibility:o,rootMargin:l,root:f,triggerOnce:i,skip:n,initialInView:r,fallbackInView:a,onChange:x}={}){var d;const[g,y]=u.useState(null),b=u.useRef(),[v,B]=u.useState({inView:!!r,entry:void 0});b.current=x,u.useEffect(()=>{if(n||!g)return;let h;return h=le(g,(R,w)=>{B({inView:R,entry:w}),b.current&&b.current(R,w),w.isIntersecting&&i&&h&&(h(),h=void 0)},{root:f,rootMargin:l,threshold:e,trackVisibility:o,delay:s},a),()=>{h&&h()}},[Array.isArray(e)?e.toString():e,g,f,l,i,n,o,a,s]);const S=(d=v.entry)==null?void 0:d.target,C=u.useRef();!g&&S&&!i&&!n&&C.current!==S&&(C.current=S,B({inView:!!r,entry:void 0}));const p=[y,v.inView,v.entry];return p.ref=p[0],p.inView=p[1],p.entry=p[2],p}const Le=()=>{const{ref:e,inView:s}=ue(),[o,l]=u.useState(""),f=A(),[i]=H("(max-width: 540px)"),n=V(),r=n.pathname.split("/")[1].replace(/-/g," "),a=new URLSearchParams(n.search),x=a.get("sort")||"",[d,g]=u.useState([]),[y,b]=u.useState([]),{data:v,fetchNextPage:B,isFetchingNextPage:S,hasNextPage:C,isPending:p}=_(o,JSON.stringify(d),JSON.stringify(y));u.useEffect(()=>{g([]),b([])},[n,n.pathname]),u.useEffect(()=>{l(x)},[x]),u.useEffect(()=>{s&&C&&!S&&B()},[s,C,S]);const h=m=>{l(m.value),m.value!==""&&(a.set("sort",m.value),f(`?${a.toString()}`))},R=(m,j)=>{g(m.target.checked?[...d,j]:d.filter(c=>c!==j)),window.scroll({top:0,behavior:"smooth"})},w=(m,j)=>{b(m.target.checked?[...y,j]:y.filter(c=>c!==j)),window.scroll({top:0,behavior:"smooth"})},{isOpen:D,onOpen:N,onClose:P}=k();return t.jsxs(W,{as:"section",id:"collection",maxW:{base:"98vw",md:"95vw"},py:10,children:[t.jsxs(F,{gap:4,flexDir:i?"column":"row",justify:i?"center":"space-between",align:i?"start":"space-between",children:[t.jsxs($,{gap:2,children:[t.jsx(J,{fontSize:{base:"18px",sm:"20px",md:"22px",lg:"24px"},fontWeight:500,textTransform:"capitalize",children:r}),t.jsx(Y,{})]}),t.jsx(se,{isControlled:!1,value:o,placeholder:"Sort by",name:"sort",handleChange:h,options:Z})]}),t.jsxs(ee,{isOpen:D,onClose:P,children:[t.jsx(M,{onClose:P}),t.jsx(O,{handleSizeSelect:R,handleColorSelect:w})]}),t.jsx(U,{"aria-label":"Filter",icon:t.jsx(z,{as:te,boxSize:6}),p:1,colorScheme:"gray",display:{base:"block",md:"none"},onClick:N}),t.jsxs(F,{py:4,gap:4,children:[t.jsx(F,{w:{sm:"200px",md:"250px"},display:{base:"none",md:"flex"},minH:window.innerHeight,children:t.jsxs(F,{flexDir:"column",gap:4,w:"full",children:[t.jsx(M,{}),t.jsx(O,{handleSizeSelect:R,handleColorSelect:w})]})}),p?t.jsx(q,{}):t.jsxs(F,{flexDir:"column",gap:4,w:"full",children:[v==null?void 0:v.pages.map((m,j)=>t.jsx(L,{children:t.jsx(Q,{columnsCountBreakPoints:re,children:t.jsx(G,{gutter:i?"10px":"20px",children:m.data.map(c=>t.jsx(ne,{data:c,discountPercent:c==null?void 0:c.discount,colorOptions:(c==null?void 0:c.product_properties)&&c.product_properties},c.id))})})},j)),t.jsx(L,{ref:e,h:"1px"}),t.jsx(K,{gap:4,py:10,align:"center",justify:"center",children:S&&t.jsx(z,{as:X,boxSize:20})})]})]})]})};export{Le as default};
