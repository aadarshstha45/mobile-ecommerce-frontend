import{j as e,g as C,F as $,L as M,I as P,T as g,r as R,Y as k,an as B,ao as H,ap as q,aq as A,aG as E,ar as O,P as V,Q as G,ab as N,V as W,aH as D,a as T,W as Q}from"./index-lyI6rhgr.js";import{a as Y,b as J,c as K}from"./index-BH9Qhcnk.js";import{T as z,a as L,b as I,c as b,d,e as _,f as m}from"./chunk-MGVPL3OH-BCm0DndI.js";import"./SelectInput-CWgEEIq9.js";import{a as U}from"./TextInput-CsWWPEC7.js";import{o as X,n as S,s as Z,t as ee}from"./zod-4ZHByuQT.js";import{S as se}from"./chunk-6SZ7MXCX-LhrZHqu4.js";import{F as w}from"./chunk-H46NUPBZ-DIaA_ULh.js";import{R as ae,a as re}from"./chunk-RDF2AYID-Dvscv_fc.js";import{T as ne,b as te,c as ie,d as oe,e as F}from"./chunk-IAXSQ4X2-De7NYeMj.js";import"./x-Nu1_7VwP.js";const le=()=>{const{data:r,isPending:t}=Y();return t?e.jsx(C,{}):r&&r.length>0?e.jsx(z,{children:e.jsxs(L,{colorScheme:"primary",children:[e.jsx(I,{children:e.jsxs(b,{children:[e.jsx(d,{children:"Product"}),e.jsx(d,{children:"Rating"}),e.jsx(d,{children:"Review"})]})}),e.jsx(_,{children:r.map((s,i)=>{var n,o,c;return e.jsxs(b,{children:[e.jsx(m,{children:e.jsxs($,{gap:4,as:M,to:s.subcategory?`/products/${(n=s.category)==null?void 0:n.slug}/${(o=s.subcategory)==null?void 0:o.slug}/${s.id}`:`/products/${(c=s.category)==null?void 0:c.slug}/${s.id}`,children:[e.jsx(P,{src:s.product.image,alt:s.product.name,boxSize:"100px",objectFit:"cover"}),e.jsx(g,{children:s.product.name})]})}),e.jsx(m,{children:s.rating}),e.jsx(m,{children:s.review})]},i)})})]})}):e.jsx(g,{children:"No reviews found"})},ce=X({product_id:S(),rating:S().min(1,{message:"Rating is required"}),review:Z().min(1,{message:"Review is required"})}),de=({onClose:r,isOpen:t,productId:s})=>{const[i,n]=R.useState(-1),{control:o,handleSubmit:c,setValue:j,reset:y,formState:{errors:a}}=k({defaultValues:{product_id:s,rating:0,review:""},resolver:ee(ce)});R.useEffect(()=>{s!==null&&j("product_id",s)},[s,j]);const{mutateAsync:f,isPending:h}=J(),u=async p=>{await f(p),r()},x=()=>{r(),y(),n(-1)};return e.jsxs(B,{isOpen:t,onClose:x,motionPreset:"slideInTop",children:[e.jsx(H,{}),e.jsxs(q,{children:[e.jsx(A,{}),e.jsx(E,{children:"Add Review"}),e.jsx(O,{children:e.jsxs("form",{onSubmit:c(u),id:"review-form",noValidate:!0,children:[e.jsxs(V,{mb:4,children:[e.jsx(w,{mb:2,fontSize:{sm:"14px",md:"16px"},fontWeight:450,children:"Rating"}),e.jsx(G,{name:"rating",control:o,render:({field:{onChange:p,value:v}})=>e.jsx(ae,{value:v.toString(),onChange:p,onMouseLeave:()=>n(-1),children:e.jsx(N,{gap:0,children:[...Array(5)].map((je,l)=>e.jsxs(w,{htmlFor:`rating_${l}`,onMouseEnter:()=>n(l+1),onClick:()=>p(l+1),cursor:"pointer",children:[e.jsx(se,{w:6,h:6,color:l<(i>=0?i:v)?"yellow.400":"gray.300"}),e.jsx(re,{display:"none",id:`rating_${l}`,value:(l+1).toString()})]},l))})})}),a.rating&&e.jsx(W,{color:"red.400",fontSize:{base:"14px",md:"16px"},fontStyle:"italic",children:a.rating.message})]}),e.jsx(U,{errors:a,type:"textarea",control:o,name:"review",label:"Review",isRequired:!0})]})}),e.jsxs(D,{gap:1,children:[e.jsx(T,{size:"sm",colorScheme:"gray",variant:"outline",onClick:x,children:"Cancel"}),e.jsx(T,{size:"sm",form:"review-form",type:"submit",isLoading:h,children:"Submit"})]})]})]})},me=()=>{const{data:r,isPending:t}=K(),[s,i]=R.useState(null),{isOpen:n,onOpen:o,onClose:c}=Q(),j=a=>{i(a),o()},y=()=>{i(null),c()};return e.jsxs(e.Fragment,{children:[e.jsx(de,{onClose:y,isOpen:n,productId:s}),t?e.jsx(C,{}):r&&r.length>0?e.jsx(z,{children:e.jsxs(L,{colorScheme:"primary",children:[e.jsx(I,{children:e.jsxs(b,{children:[e.jsx(d,{children:"Product"}),e.jsx(d,{}),e.jsx(d,{children:"Review"})]})}),e.jsx(_,{children:r.map((a,f)=>{var h,u,x;return e.jsxs(b,{children:[e.jsx(m,{children:e.jsxs($,{gap:4,as:M,to:a.subcategory?`/products/${(h=a.category)==null?void 0:h.slug}/${(u=a.subcategory)==null?void 0:u.slug}/${a.id}`:`/products/${(x=a.category)==null?void 0:x.slug}/${a.id}`,children:[e.jsx(P,{src:a.image,alt:a.name,w:{base:"100px",md:"150px"},aspectRatio:1/1}),e.jsx(g,{fontSize:{base:"14px",md:"16px",lg:"18px"},children:a.name})]})}),e.jsx(m,{}),e.jsx(m,{children:e.jsx(T,{onClick:()=>j(a.id),variant:"outline",children:"Review"})})]},f)})})]})}):e.jsx(g,{children:"No orders left to be reviewed"})]})},xe=[{name:"To Review"},{name:"Reviewed"}],we=()=>e.jsxs(ne,{isLazy:!0,position:"relative",variant:"unstyled",children:[e.jsx(te,{children:xe.map((r,t)=>e.jsx(ie,{_selected:{textColor:"white",bg:"primary.500",borderRadius:2},fontSize:{base:"sm",md:"md",xl:"lg"},children:r.name},t))}),e.jsxs(oe,{mt:8,children:[e.jsx(F,{p:0,children:e.jsx(me,{})}),e.jsx(F,{p:0,children:e.jsx(le,{})})]})]});export{we as default};
