import{r as m,a as E,b as L,c as M,j as n,C as T,L as A,F as C,S as F,T as N,B as P,M as V,e as z,ar as D,x as W}from"./index-CjMTo5K3.js";import{b as _,c as $,I as O}from"./index-Bxaf2EVv.js";import{L as U}from"./index-DQqJJrFv.js";import{B as H}from"./index-CltgwPlP.js";import{S as Q}from"./SelectInput-CsXsqzP9.js";import{s as q}from"./data-BjPZZWce.js";import"./index-BgYDWQw4.js";import"./GoogleIcon-DDsVtFCt.js";import"./TextInput-DMFAb_np.js";import"./x-BO8iIHbQ.js";import"./chunk-H46NUPBZ-3MtO_oMd.js";import"./auth-DQFMyoN7.js";import"./zod-BsI7OYO9.js";import"./chunk-EC6XFFZH-QL08M3Ba.js";import"./chunk-2EW3JUUD-z4RRGOG-.js";import"./chunk-YQO7BFFX--yn25mem.js";import"./chunk-FHHZMTWR-DDK670cj.js";import"./shopping-bag-D-RPX0az.js";import"./chevron-right-CVCaZrRX.js";var R=new Map,w=new WeakMap,B=0,G=void 0;function J(e){return e?(w.has(e)||(B+=1,w.set(e,B.toString())),w.get(e)):"0"}function K(e){return Object.keys(e).sort().filter(t=>e[t]!==void 0).map(t=>`${t}_${t==="root"?J(e.root):e[t]}`).toString()}function X(e){const t=K(e);let o=R.get(t);if(!o){const c=new Map;let u;const r=new IntersectionObserver(i=>{i.forEach(s=>{var a;const f=s.isIntersecting&&u.some(l=>s.intersectionRatio>=l);e.trackVisibility&&typeof s.isVisible>"u"&&(s.isVisible=f),(a=c.get(s.target))==null||a.forEach(l=>{l(f,s)})})},e);u=r.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),o={id:t,observer:r,elements:c},R.set(t,o)}return o}function Y(e,t,o={},c=G){if(typeof window.IntersectionObserver>"u"&&c!==void 0){const a=e.getBoundingClientRect();return t(c,{isIntersecting:c,target:e,intersectionRatio:typeof o.threshold=="number"?o.threshold:0,time:0,boundingClientRect:a,intersectionRect:a,rootBounds:a}),()=>{}}const{id:u,observer:r,elements:i}=X(o),s=i.get(e)||[];return i.has(e)||i.set(e,s),s.push(t),r.observe(e),function(){s.splice(s.indexOf(t),1),s.length===0&&(i.delete(e),r.unobserve(e)),i.size===0&&(r.disconnect(),R.delete(u))}}function Z({threshold:e,delay:t,trackVisibility:o,rootMargin:c,root:u,triggerOnce:r,skip:i,initialInView:s,fallbackInView:a,onChange:f}={}){var l;const[d,j]=m.useState(null),v=m.useRef(),[b,p]=m.useState({inView:!!s,entry:void 0});v.current=f,m.useEffect(()=>{if(i||!d)return;let x;return x=Y(d,(I,y)=>{p({inView:I,entry:y}),v.current&&v.current(I,y),y.isIntersecting&&r&&x&&(x(),x=void 0)},{root:u,rootMargin:c,threshold:e,trackVisibility:o,delay:t},a),()=>{x&&x()}},[Array.isArray(e)?e.toString():e,d,u,c,r,i,o,a,t]);const S=(l=b.entry)==null?void 0:l.target,g=m.useRef();!d&&S&&!r&&!i&&g.current!==S&&(g.current=S,p({inView:!!s,entry:void 0}));const h=[j,b.inView,b.entry];return h.ref=h[0],h.inView=h[1],h.entry=h[2],h}const ve=()=>{const{ref:e,inView:t}=Z(),[o,c]=m.useState(""),u=E(),[r]=L("(max-width: 540px)"),i=M(),s=new URLSearchParams(i.search),a=s.get("sort")||"",{data:f,fetchNextPage:l,isFetchingNextPage:d,hasNextPage:j,isPending:v}=_(o);console.log(f),m.useEffect(()=>{c(a)},[a]),m.useEffect(()=>{t&&j&&!d&&(console.log("fetching next page"),l())},[t,j,d]);const b=p=>{c(p.value),p.value!==""&&(s.set("sort",p.value),u(`?${s.toString()}`))};return n.jsx(T,{as:"section",id:"collection",maxW:{base:"98vw",md:"95vw",lg:"80vw"},py:10,children:v?n.jsx(A,{}):n.jsxs(C,{flexDir:"column",gap:4,children:[n.jsxs(C,{gap:4,flexDir:r?"column":"row",justify:r?"center":"space-between",align:r?"start":"space-between",children:[n.jsxs(F,{gap:2,children:[n.jsx(N,{fontSize:{base:"18px",sm:"20px",md:"22px",lg:"24px"},fontWeight:500,children:"Shop Now"}),n.jsx(H,{})]}),n.jsx(Q,{isControlled:!1,value:o,placeholder:"Sort by",name:"sort",handleChange:b,options:q})]}),f==null?void 0:f.pages.map((p,S)=>n.jsx(P,{children:n.jsx(V,{columnsCountBreakPoints:$,children:n.jsx(z,{gutter:r?"10px":"20px",children:p.data.map(g=>n.jsx(O,{data:g,discountPercent:g==null?void 0:g.discount},g.id))})})},S)),n.jsx(P,{ref:e,h:"1px"}),n.jsx(D,{gap:4,py:10,align:"center",justify:"center",children:d&&n.jsx(W,{as:U,boxSize:20})})]})})};export{ve as default};
