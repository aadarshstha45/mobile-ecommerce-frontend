import{r as p,k as D,l as A,n as V,aN as _,q as k,j as t,C as H,F,S as W,T as $,s as J,L as U,B as z,M as q,t as Q,H as G,R as K}from"./index-rCYdBeUT.js";import{L as X}from"./index-DVboiAC3.js";import{B as Y}from"./index-CoxaMLD1.js";import{s as Z,F as ee,C as E,a as L,S as te}from"./data-CA2HLIOA.js";import{S as se}from"./SelectInput-DxnnzD74.js";import{c as re,I as ne}from"./index-DVanLnQW.js";import"./chevron-right-BEQb1eTP.js";import"./index.esm-BEs4eRLS.js";import"./chunk-H46NUPBZ-BtDstPpZ.js";import"./index-CpTF5bfx.js";import"./GoogleIcon-mC7TplVf.js";import"./TextInput-DNlvfKru.js";import"./x-lm0Of-A3.js";import"./auth-CnU8sUV9.js";import"./zod-C56sn-lH.js";import"./chunk-EC6XFFZH-DejpOusK.js";import"./chunk-6SZ7MXCX-ChuMaEWf.js";import"./chunk-2EW3JUUD-BbqAtEyR.js";import"./chunk-YQO7BFFX-BHnX-Dd0.js";import"./chunk-FHHZMTWR-QlcKCjnW.js";import"./shopping-bag-C15s6Ycf.js";var P=new Map,I=new WeakMap,M=0,ie=void 0;function oe(e){return e?(I.has(e)||(M+=1,I.set(e,M.toString())),I.get(e)):"0"}function ae(e){return Object.keys(e).sort().filter(s=>e[s]!==void 0).map(s=>`${s}_${s==="root"?oe(e.root):e[s]}`).toString()}function ce(e){const s=ae(e);let i=P.get(s);if(!i){const l=new Map;let d;const n=new IntersectionObserver(o=>{o.forEach(r=>{var a;const x=r.isIntersecting&&d.some(u=>r.intersectionRatio>=u);e.trackVisibility&&typeof r.isVisible>"u"&&(r.isVisible=x),(a=l.get(r.target))==null||a.forEach(u=>{u(x,r)})})},e);d=n.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),i={id:s,observer:n,elements:l},P.set(s,i)}return i}function le(e,s,i={},l=ie){if(typeof window.IntersectionObserver>"u"&&l!==void 0){const a=e.getBoundingClientRect();return s(l,{isIntersecting:l,target:e,intersectionRatio:typeof i.threshold=="number"?i.threshold:0,time:0,boundingClientRect:a,intersectionRect:a,rootBounds:a}),()=>{}}const{id:d,observer:n,elements:o}=ce(i),r=o.get(e)||[];return o.has(e)||o.set(e,r),r.push(s),n.observe(e),function(){r.splice(r.indexOf(s),1),r.length===0&&(o.delete(e),n.unobserve(e)),o.size===0&&(n.disconnect(),P.delete(d))}}function ue({threshold:e,delay:s,trackVisibility:i,rootMargin:l,root:d,triggerOnce:n,skip:o,initialInView:r,fallbackInView:a,onChange:x}={}){var u;const[j,w]=p.useState(null),y=p.useRef(),[g,B]=p.useState({inView:!!r,entry:void 0});y.current=x,p.useEffect(()=>{if(o||!j)return;let h;return h=le(j,(R,b)=>{B({inView:R,entry:b}),y.current&&y.current(R,b),b.isIntersecting&&n&&h&&(h(),h=void 0)},{root:d,rootMargin:l,threshold:e,trackVisibility:i,delay:s},a),()=>{h&&h()}},[Array.isArray(e)?e.toString():e,j,d,l,n,o,i,a,s]);const v=(u=g.entry)==null?void 0:u.target,C=p.useRef();!j&&v&&!n&&!o&&C.current!==v&&(C.current=v,B({inView:!!r,entry:void 0}));const f=[w,g.inView,g.entry];return f.ref=f[0],f.inView=f[1],f.entry=f[2],f}const Le=()=>{const{ref:e,inView:s}=ue(),[i,l]=p.useState(""),d=D(),[n]=A("(max-width: 540px)"),o=V(),r=o.pathname.split("/")[1].replace(/-/g," "),a=new URLSearchParams(o.search),x=a.get("sort")||"",[u,j]=p.useState([]),[w,y]=p.useState([]),{data:g,fetchNextPage:B,isFetchingNextPage:v,hasNextPage:C,isPending:f}=_(i,JSON.stringify(u),JSON.stringify(w));p.useEffect(()=>{l(x)},[x]),p.useEffect(()=>{s&&C&&!v&&B()},[s,C,v]);const h=m=>{l(m.value),m.value!==""&&(a.set("sort",m.value),d(`?${a.toString()}`))},R=(m,S)=>{j(m.target.checked?[...u,S]:u.filter(c=>c!==S)),window.scroll({top:0,behavior:"smooth"})},b=(m,S)=>{y(m.target.checked?[...w,S]:w.filter(c=>c!==S)),window.scroll({top:0,behavior:"smooth"})},{isOpen:N,onOpen:O,onClose:T}=k();return t.jsxs(H,{as:"section",id:"collection",maxW:{base:"98vw",md:"95vw"},py:10,children:[t.jsxs(F,{gap:4,flexDir:n?"column":"row",justify:n?"center":"space-between",align:n?"start":"space-between",children:[t.jsxs(W,{gap:2,children:[t.jsx($,{fontSize:{base:"18px",sm:"20px",md:"22px",lg:"24px"},fontWeight:500,textTransform:"capitalize",children:r}),t.jsx(Y,{})]}),t.jsx(se,{isControlled:!1,value:i,placeholder:"Sort by",name:"sort",handleChange:h,options:Z})]}),t.jsxs(ee,{isOpen:N,onClose:T,children:[t.jsx(E,{}),t.jsx(L,{handleSizeSelect:R,handleColorSelect:b})]}),t.jsx(J,{"aria-label":"Filter",as:te,cursor:"pointer",size:"xs",p:1,colorScheme:"gray",display:{base:"block",sm:"none"},onClick:O}),t.jsxs(F,{py:4,gap:4,children:[t.jsx(F,{w:{sm:"200px",md:"250px"},display:{base:"none",sm:"flex"},minH:window.innerHeight,children:t.jsxs(F,{flexDir:"column",gap:4,w:"full",children:[t.jsx(E,{}),t.jsx(L,{handleSizeSelect:R,handleColorSelect:b})]})}),f?t.jsx(U,{}):t.jsxs(F,{flexDir:"column",gap:4,w:"full",children:[g==null?void 0:g.pages.map((m,S)=>t.jsx(z,{children:t.jsx(q,{columnsCountBreakPoints:re,children:t.jsx(Q,{gutter:n?"10px":"20px",children:m.data.map(c=>t.jsx(ne,{data:c,discountPercent:c==null?void 0:c.discount,colorOptions:(c==null?void 0:c.product_properties)&&c.product_properties},c.id))})})},S)),t.jsx(z,{ref:e,h:"1px"}),t.jsx(G,{gap:4,py:10,align:"center",justify:"center",children:v&&t.jsx(K,{as:X,boxSize:20})})]})]})]})};export{Le as default};
