import{r as f,j as d,B as C,I as A}from"./index-6Sn1wWIr.js";var S=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","#","$","%","*","+",",","-",".",":",";","=","?","@","[","]","^","_","{","|","}","~"],g=t=>{let e=0;for(let r=0;r<t.length;r++){let a=t[r],n=S.indexOf(a);e=e*83+n}return e},x=t=>{let e=t/255;return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)},M=t=>{let e=Math.max(0,Math.min(1,t));return e<=.0031308?Math.trunc(e*12.92*255+.5):Math.trunc((1.055*Math.pow(e,.4166666666666667)-.055)*255+.5)},T=t=>t<0?-1:1,j=(t,e)=>T(t)*Math.pow(Math.abs(t),e),D=class extends Error{constructor(t){super(t),this.name="ValidationError",this.message=t}},V=t=>{if(!t||t.length<6)throw new D("The blurhash string must be at least 6 characters");let e=g(t[0]),r=Math.floor(e/9)+1,a=e%9+1;if(t.length!==4+2*a*r)throw new D(`blurhash length mismatch: length is ${t.length} but it should be ${4+2*a*r}`)},q=t=>{let e=t>>16,r=t>>8&255,a=t&255;return[x(e),x(r),x(a)]},G=(t,e)=>{let r=Math.floor(t/361),a=Math.floor(t/19)%19,n=t%19;return[j((r-9)/9,2)*e,j((a-9)/9,2)*e,j((n-9)/9,2)*e]},H=(t,e,r,a)=>{V(t),a=a|1;let n=g(t[0]),i=Math.floor(n/9)+1,s=n%9+1,u=(g(t[1])+1)/166,l=new Array(s*i);for(let o=0;o<l.length;o++)if(o===0){let h=g(t.substring(2,6));l[o]=q(h)}else{let h=g(t.substring(4+o*2,6+o*2));l[o]=G(h,u*a)}let c=e*4,p=new Uint8ClampedArray(c*r);for(let o=0;o<r;o++)for(let h=0;h<e;h++){let O=0,E=0,L=0;for(let m=0;m<i;m++)for(let w=0;w<s;w++){let v=Math.cos(Math.PI*h*w/e)*Math.cos(Math.PI*o*m/r),y=l[w+m*s];O+=y[0]*v,E+=y[1]*v,L+=y[2]*v}let B=M(O),F=M(E),k=M(L);p[4*h+0+o*c]=B,p[4*h+1+o*c]=F,p[4*h+2+o*c]=k,p[4*h+3+o*c]=255}return p},J=H,K=Object.defineProperty,N=Object.defineProperties,Q=Object.getOwnPropertyDescriptors,b=Object.getOwnPropertySymbols,X=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable,R=(t,e,r)=>e in t?K(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,P=(t,e)=>{for(var r in e||(e={}))X.call(e,r)&&R(t,r,e[r]);if(b)for(var r of b(e))Y.call(e,r)&&R(t,r,e[r]);return t},I=(t,e)=>N(t,Q(e)),z=(t,e)=>{var r={};for(var a in t)X.call(t,a)&&e.indexOf(a)<0&&(r[a]=t[a]);if(t!=null&&b)for(var a of b(t))e.indexOf(a)<0&&Y.call(t,a)&&(r[a]=t[a]);return r},$=class extends f.PureComponent{constructor(){super(...arguments),this.canvas=null,this.handleRef=t=>{this.canvas=t,this.draw()},this.draw=()=>{let{hash:t,height:e,punch:r,width:a}=this.props;if(this.canvas){let n=J(t,a,e,r),i=this.canvas.getContext("2d"),s=i.createImageData(a,e);s.data.set(n),i.putImageData(s,0,0)}}}componentDidUpdate(){this.draw()}render(){let t=this.props,{hash:e,height:r,width:a}=t,n=z(t,["hash","height","width"]);return f.createElement("canvas",I(P({},n),{height:r,width:a,ref:this.handleRef}))}};$.defaultProps={height:128,width:128};var W={position:"absolute",top:0,bottom:0,left:0,right:0,width:"100%",height:"100%"},U=class extends f.PureComponent{componentDidUpdate(){if(this.props.resolutionX<=0)throw new Error("resolutionX must be larger than zero");if(this.props.resolutionY<=0)throw new Error("resolutionY must be larger than zero")}render(){let t=this.props,{hash:e,height:r,width:a,punch:n,resolutionX:i,resolutionY:s,style:u}=t,l=z(t,["hash","height","width","punch","resolutionX","resolutionY","style"]);return f.createElement("div",I(P({},l),{style:I(P({display:"inline-block",height:r,width:a},u),{position:"relative"})}),f.createElement($,{hash:e,height:s,width:i,punch:n,style:W}))}};U.defaultProps={height:128,width:128,resolutionX:32,resolutionY:32};const _=({id:t,src:e,alt:r,placeholder:a,w:n,h:i,...s})=>{const[u,l]=f.useState({}),c=p=>{l(o=>({...o,[p]:!0}))};return d.jsxs(d.Fragment,{children:[!u[t]&&a?d.jsx(U,{hash:a,width:"100%",height:"100%",resolutionX:32,resolutionY:32,punch:1,style:{filter:u[t]?"blur(10px)":"none",transition:"filter 0.5s ease-in-out"}}):d.jsx(C,{width:"full",height:"full",bg:"primary.100"}),d.jsx(A,{src:e,alt:r,loading:"lazy",fallback:d.jsx(C,{width:"full",height:"full",bg:"primary.100"}),objectFit:"cover",onLoad:()=>c(t),opacity:u[t]?1:0,transition:"opacity 0.3s ease-in-out",w:n??"full",aspectRatio:1/1,objectPosition:"center",...s})]})};export{_ as L};
