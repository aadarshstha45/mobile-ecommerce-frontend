import{a0 as B,r as d,aQ as G,W as U,j as e,F as h,T,a3 as y,at as V}from"./index-BISsgrs9.js";import{R as z}from"./DatePicker-C_E5ePQh.js";import{P as A}from"./PhoneInput-DPhXZ9HV.js";import{S as L,c as X}from"./SelectInput-DgrB4gdK.js";import{T as m}from"./TextInput-BhA_o2nr.js";import{o as Y,s as t,u as H,d as M,t as Q}from"./zod-DtJGCBLh.js";import{S as q,G as l}from"./chunk-ZPFGWTBB-DjIHd1pL.js";import"./index.esm-jS8sanS8.js";import"./chunk-H46NUPBZ-Dd1bnTT1.js";const W=s=>{if(s instanceof Date)return s.toISOString().split("T")[0];if(typeof s=="string")return s;throw new Error("Invalid date format")},J=Y({name:t().min(1,{message:"Name is required"}),email:t().email({message:"Enter a valid email address"}).min(1,{message:"Email is required"}),phone_number:t().min(1,{message:"Phone number is required"}).min(8,{message:"Phone number should be atleast 8 digits"}).max(14,{message:"Phone number should not be 14 digits"}),dob:H([M(),t()]).optional(),country:t().min(1,{message:"Country is required"}),city:t().min(1,{message:"City is required"}),street:t().optional(),landmark:t().optional()}),te=()=>{var g,j,S,R;const s=B(),[n,u]=d.useState(!0),{mutateAsync:D,isPending:v,error:p,isError:I}=G(),{control:a,reset:f,handleSubmit:F,formState:{errors:r}}=U({defaultValues:{name:"",email:"",phone_number:"",country:"",city:"",street:"",landmark:"",country_code:"",dob:""},resolver:Q(J)}),[x,b]=d.useState((j=(g=s==null?void 0:s.shipping_details)==null?void 0:g[0])==null?void 0:j.country_code);if(d.useEffect(()=>{window.scrollTo(0,0)},[]),d.useEffect(()=>{var o,c;const i=(c=(o=s==null?void 0:s.shipping_details)==null?void 0:o[0])==null?void 0:c.country_code;i&&b(i)},[s]),I){const i=(R=(S=p==null?void 0:p.response)==null?void 0:S.data)==null?void 0:R.errors;console.log(i)}d.useEffect(()=>{var i,o,c,_,C,O,w,E,P,k;s&&f({name:s.name??"",email:s.email??"",phone_number:((o=(i=s.shipping_details)==null?void 0:i[0])==null?void 0:o.phone_number)??"",dob:s.dob??"",country:((_=(c=s.shipping_details)==null?void 0:c[0])==null?void 0:_.country)??"",city:((O=(C=s.shipping_details)==null?void 0:C[0])==null?void 0:O.city)??"",street:((E=(w=s.shipping_details)==null?void 0:w[0])==null?void 0:E.street)??"",landmark:((k=(P=s.shipping_details)==null?void 0:P[0])==null?void 0:k.landmark)??""})},[s,f]);const N=async i=>{await D({...i,country_code:x,dob:W(i.dob)}),u(!0)};return e.jsxs(h,{as:"form",onSubmit:F(N),w:"full",flexDir:"column",gap:8,noValidate:!0,children:[e.jsxs(h,{flexDir:"column",gap:4,children:[e.jsx(T,{fontSize:"xl",children:"Profile Details"}),e.jsxs(q,{w:"full",columns:{base:1,md:2},spacingX:10,spacingY:4,children:[e.jsx(l,{colSpan:1,children:e.jsx(m,{isReadOnly:n,isRequired:!n,name:"name",label:"Full Name",control:a,errors:r})}),e.jsx(l,{colSpan:1,children:e.jsx(m,{isReadOnly:!0,name:"email",label:"Email",message:" * Email cannot be changed.",control:a,errors:r})}),e.jsx(l,{colSpan:1,children:e.jsx(A,{defaultValue:x,handleChange:i=>{b(i.value)},name:"phone_number",label:"Phone Number",control:a,errors:r,isRequired:!n,isReadOnly:n})}),e.jsx(l,{colSpan:1,children:e.jsx(z,{isReadOnly:n,name:"dob",label:"Birthday (Optional)",control:a,errors:r})})]})]}),e.jsxs(h,{w:"full",flexDir:"column",gap:4,children:[e.jsx(T,{fontSize:"xl",children:"Billing Address"}),e.jsxs(q,{w:"full",columns:{base:1,md:2},spacingX:10,spacingY:4,children:[e.jsx(l,{colSpan:1,children:e.jsx(L,{width:"full",label:"Country",options:X,name:"country",isControlled:!0,isRequired:!n,placeholder:"Select Country",control:a,isReadOnly:n,errors:r})}),e.jsx(l,{colSpan:1,children:e.jsx(m,{isReadOnly:n,isRequired:!n,name:"city",label:"City",control:a,errors:r})}),e.jsx(l,{colSpan:1,children:e.jsx(m,{isReadOnly:n,name:"street",label:"Street",control:a,errors:r})}),e.jsx(l,{colSpan:1,children:e.jsx(m,{isReadOnly:n,name:"landmark",label:"Nearest Landmark",control:a,errors:r})})]})]}),n?e.jsx(y,{w:"fit-content",borderRadius:3,onClick:()=>u(!1),colorScheme:"primary",children:"Edit"}):e.jsxs(V,{w:"full",children:[e.jsx(y,{isLoading:v,borderRadius:3,type:"submit",colorScheme:"primary",children:"Update"}),e.jsx(y,{borderRadius:3,variant:"outline",onClick:()=>u(!0),colorScheme:"primary",children:"Cancel"})]})]})};export{te as default};
