import{r as S,bh as F,j as e,bg as v,q as A,F as g,T as a,a3 as k,B as R,t as j,H as u,S as z,Z as C,ac as D}from"./index-CkiCkVzJ.js";import{u as I}from"./orderStore-CIuJuTdJ.js";import{a as l,b as P}from"./TextInput-BLwJ8rby.js";import{a as N,C as q,M as O}from"./ModalForm-302FXM4F.js";import{C as B}from"./PlusCircle-BfJShnFn.js";import{u as _,C as V}from"./index.esm-CeDGwYn6.js";import{S as L,c as T,P as E,C as H}from"./SelectInput-Cp7MsvuN.js";import{R as M,a as G}from"./chunk-RDF2AYID-Dc0fXYFF.js";import{F as Z}from"./chunk-H46NUPBZ-GRMvZQK7.js";import"./X-BNpK52mh.js";const J=({isOpen:c,onClose:n})=>{const[d,m]=S.useState("Nepal"),[x,p]=S.useState("+977"),o=F(),{control:s,handleSubmit:h,formState:{errors:b}}=_({defaultValues:{country:"",city:"",address:"",street:"",landmark:"",recipient_name:"",phone_number:"",is_billing_address:!1}}),f=async r=>{await o.mutateAsync({...r,country:d,country_code:x}),n()};return e.jsxs(N,{form:"shipping-address-form",isOpen:c,onClose:n,heading:"Add Address",onSubmit:h(f),isLoading:o.isPending,isDisabled:o.isPending,children:[e.jsx(L,{width:"full",label:"Country",options:T,name:"country",isControlled:!0,isRequired:!0,defaultValue:d,handleChange:r=>{m(r.value),p(r.dial_code)},placeholder:"Select Country",control:s}),e.jsx(l,{label:"City",control:s,name:"city",isRequired:!0}),e.jsx(l,{label:"Address",control:s,name:"address"}),e.jsx(l,{label:"Street",control:s,name:"street"}),e.jsx(l,{label:"Landmark",control:s,name:"landmark"}),e.jsx(l,{label:"Recipient Name",control:s,name:"recipient_name",isRequired:!0}),e.jsx(E,{defaultValue:H,handleChange:r=>{m(r.name),p(r.value)},name:"phone_number",label:"Phone Number",control:s,errors:b,isRequired:!0}),e.jsx(q,{control:s,name:"is_billing_address",label:"Set as default billing address"})]})},re=({stepProps:c})=>{const{data:n,isRefetching:d}=v(),{stepData:m,setStepData:x}=I(),{isOpen:p,onOpen:o,onClose:s}=A(),{control:h,handleSubmit:b}=_({defaultValues:{delivery_address_id:""}}),f=t=>{if(!t.delivery_address_id){D.error("Please select a delivery address");return}x({...m,delivery_address_id:t.delivery_address_id}),c.nextStep()},r=()=>{c.prevStep()};return e.jsxs(g,{flexDir:"column",gap:4,children:[e.jsxs("form",{id:"shipping-details-form",onSubmit:b(f),children:[e.jsx(V,{name:"delivery_address_id",control:h,render:({field:{value:t,onChange:w}})=>e.jsx(M,{value:t,onChange:w,children:e.jsxs(g,{w:"full",flexDir:"column",gap:4,children:[e.jsx(a,{fontSize:"xl",children:"Select Delivery Address"}),d?e.jsx("div",{className:"loader"}):n&&n.length>0?n.map((i,y)=>e.jsxs(k,{children:[e.jsxs(Z,{bg:parseInt(t)===i.id?"#f5f5f5":"",w:{base:"full",lg:"60%"},border:parseInt(t)===i.id?"2px solid":"1px solid",borderRadius:2,p:4,pos:"relative",borderColor:parseInt(t)===i.id?"green":"#000",htmlFor:i.id,children:[e.jsx(R,{bg:"green",w:4,h:4,pos:"absolute",top:2,right:2,display:parseInt(t)===i.id?"block":"none",overflow:"hidden",children:e.jsx(j,{as:P,color:"white",boxSize:4})}),e.jsxs(u,{spacing:4,align:"start",children:[e.jsx(j,{as:O,color:"primary.500",boxSize:8}),e.jsxs(z,{spacing:2,children:[e.jsx(u,{spacing:4,children:e.jsxs(a,{fontSize:{base:"14px",md:"18px"},children:[i.address&&i.address+","," ",(i==null?void 0:i.street)&&(i==null?void 0:i.street)+","," ",i==null?void 0:i.city,",",i==null?void 0:i.country]})}),e.jsx(a,{fontSize:{base:"14px",md:"18px"},children:i==null?void 0:i.landmark})]})]})]}),e.jsx(G,{isChecked:t===i.id,id:i.id,value:i.id,display:"none"},y)]},y)):e.jsx(a,{pb:4,fontSize:{base:"14px",md:"18px"},children:"No address saved yet"})]})})}),e.jsxs(u,{onClick:o,cursor:"pointer",color:"primary.500",w:"fit-content",children:[e.jsx(j,{as:B,boxSize:6}),e.jsx(a,{fontSize:{base:"14px",md:"18px"},children:"Add New Address"})]}),e.jsxs(u,{mt:6,justify:"space-between",children:[e.jsx(C,{colorScheme:"primary",w:"fit-content",onClick:r,size:"sm",children:"Previous"}),e.jsx(C,{colorScheme:"primary",w:"fit-content",size:"sm",type:"submit",form:"shipping-details-form",children:"Next"})]})]}),e.jsx(J,{isOpen:p,onClose:s})]})};export{re as default};
